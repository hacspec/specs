(* File automatically generated by Hacspec *)
From Hacspec Require Import Hacspec_Lib MachineIntegers.
From Coq Require Import ZArith.
Import List.ListNotations.
Open Scope Z_scope.
Open Scope bool_scope.

Require Import Hacspec_lib.

Notation t_G1_pallas_t := ((t_FpPallas_t × t_FpPallas_t × bool)).

Notation t_G1_vesta_t := ((t_FpVesta_t × t_FpVesta_t × bool)).

Notation PallasCanvas := (nseq int8 255).
Notation FpPallas_t := (nat_mod 0x40000000000000000000000000000000224698FC094CF91B992D30ED00000001).
Definition FpPallas : FpPallas_t -> FpPallas_t :=
  id.

Notation VestaCanvas := (nseq int8 255).
Notation FpVesta_t := (nat_mod 0x40000000000000000000000000000000224698FC0994A8DD8C46EB2100000001).
Definition FpVesta : FpVesta_t -> FpVesta_t :=
  id.

(*Not implemented yet? todo(item)*)

Definition g1_default_pallas : (t_FpPallas_t × t_FpPallas_t × bool) :=
  (f_ZERO,f_ZERO,true).

Definition g1_default_vesta : (t_FpVesta_t × t_FpVesta_t × bool) :=
  (f_ZERO,f_ZERO,true).

Definition g1_is_identity_pallas (p : (t_FpPallas_t × t_FpPallas_t × bool)) : bool :=
  let '(_,_,inf) := (p) : (t_FpPallas_t × t_FpPallas_t × bool) in
  inf.

Definition g1_is_identity_vesta (p : (t_FpVesta_t × t_FpVesta_t × bool)) : bool :=
  let '(_,_,inf) := (p) : (t_FpVesta_t × t_FpVesta_t × bool) in
  inf.

Definition g1_on_curve_pallas (p : (t_FpPallas_t × t_FpPallas_t × bool)) : bool :=
  let '(x,y,inf) := (p) : (t_FpPallas_t × t_FpPallas_t × bool) in
  let y_squared := (y.*y) : t_FpPallas_t in
  let x_cubed := ((x.*x).*x) : t_FpPallas_t in
  let fp5 := ((f_TWO.+f_TWO).+f_ONE) : t_FpPallas_t in
  orb (y_squared=.?(x_cubed.+fp5)) inf.

Definition g1_on_curve_vesta (p : (t_FpVesta_t × t_FpVesta_t × bool)) : bool :=
  let '(x,y,inf) := (p) : (t_FpVesta_t × t_FpVesta_t × bool) in
  let y_squared := (y.*y) : t_FpVesta_t in
  let x_cubed := ((x.*x).*x) : t_FpVesta_t in
  let fp5 := ((f_TWO.+f_TWO).+f_ONE) : t_FpVesta_t in
  orb (y_squared=.?(x_cubed.+fp5)) inf.

Definition g1add_a_pallas (p : (t_FpPallas_t × t_FpPallas_t × bool)) (q : (t_FpPallas_t × t_FpPallas_t × bool)) : (t_FpPallas_t × t_FpPallas_t × bool) :=
  let '(x1,y1,_) := (p) : (t_FpPallas_t × t_FpPallas_t × bool) in
  let '(x2,y2,_) := (q) : (t_FpPallas_t × t_FpPallas_t × bool) in
  let x_diff := (x2.-x1) : t_FpPallas_t in
  let y_diff := (y2.-y1) : t_FpPallas_t in
  let xovery := (y_diff.*(impl__FpPallas__inv x_diff)) : t_FpPallas_t in
  let x3 := (((f_exp xovery (@repr WORDSIZE32 2)).-x1).-x2) : t_FpPallas_t in
  let y3 := ((xovery.*(x1.-x3)).-y1) : t_FpPallas_t in
  (x3,y3,false).

Definition g1add_a_vesta (p : (t_FpVesta_t × t_FpVesta_t × bool)) (q : (t_FpVesta_t × t_FpVesta_t × bool)) : (t_FpVesta_t × t_FpVesta_t × bool) :=
  let '(x1,y1,_) := (p) : (t_FpVesta_t × t_FpVesta_t × bool) in
  let '(x2,y2,_) := (q) : (t_FpVesta_t × t_FpVesta_t × bool) in
  let x_diff := (x2.-x1) : t_FpVesta_t in
  let y_diff := (y2.-y1) : t_FpVesta_t in
  let xovery := (y_diff.*(impl__FpVesta__inv x_diff)) : t_FpVesta_t in
  let x3 := (((f_exp xovery (@repr WORDSIZE32 2)).-x1).-x2) : t_FpVesta_t in
  let y3 := ((xovery.*(x1.-x3)).-y1) : t_FpVesta_t in
  (x3,y3,false).

Definition g1double_a_pallas (p : (t_FpPallas_t × t_FpPallas_t × bool)) : (t_FpPallas_t × t_FpPallas_t × bool) :=
  let '(x1,y1,_) := (p) : (t_FpPallas_t × t_FpPallas_t × bool) in
  let x12 := (f_exp x1 (@repr WORDSIZE32 2)) : t_FpPallas_t in
  let xovery := (((impl__FpPallas__from_literal (@repr WORDSIZE128 3)).*x12).*(impl__FpPallas__inv (f_TWO.*y1))) : t_FpPallas_t in
  let x3 := ((f_exp xovery (@repr WORDSIZE32 2)).-(f_TWO.*x1)) : t_FpPallas_t in
  let y3 := ((xovery.*(x1.-x3)).-y1) : t_FpPallas_t in
  (x3,y3,false).

Definition g1double_a_vesta (p : (t_FpVesta_t × t_FpVesta_t × bool)) : (t_FpVesta_t × t_FpVesta_t × bool) :=
  let '(x1,y1,_) := (p) : (t_FpVesta_t × t_FpVesta_t × bool) in
  let x12 := (f_exp x1 (@repr WORDSIZE32 2)) : t_FpVesta_t in
  let xovery := (((impl__FpVesta__from_literal (@repr WORDSIZE128 3)).*x12).*(impl__FpVesta__inv (f_TWO.*y1))) : t_FpVesta_t in
  let x3 := ((f_exp xovery (@repr WORDSIZE32 2)).-(f_TWO.*x1)) : t_FpVesta_t in
  let y3 := ((xovery.*(x1.-x3)).-y1) : t_FpVesta_t in
  (x3,y3,false).

Definition g1double_pallas (p : (t_FpPallas_t × t_FpPallas_t × bool)) : (t_FpPallas_t × t_FpPallas_t × bool) :=
  let '(_x1,y1,inf1) := (p) : (t_FpPallas_t × t_FpPallas_t × bool) in
  if
    andb (y1<>f_ZERO) (not inf1)
  then
    g1double_a_pallas p
  else
    (f_ZERO,f_ZERO,true).

Definition g1add_pallas (p : (t_FpPallas_t × t_FpPallas_t × bool)) (q : (t_FpPallas_t × t_FpPallas_t × bool)) : (t_FpPallas_t × t_FpPallas_t × bool) :=
  let '(x1,y1,inf1) := (p) : (t_FpPallas_t × t_FpPallas_t × bool) in
  let '(x2,y2,inf2) := (q) : (t_FpPallas_t × t_FpPallas_t × bool) in
  if
    inf1
  then
    q
  else
    if
      inf2
    then
      p
    else
      if
        p=.?q
      then
        g1double_pallas p
      else
        if
          not (andb (x1=.?x2) (y1=.?(f_ZERO.-y2)))
        then
          g1add_a_pallas p q
        else
          (f_ZERO,f_ZERO,true).

Definition g1double_vesta (p : (t_FpVesta_t × t_FpVesta_t × bool)) : (t_FpVesta_t × t_FpVesta_t × bool) :=
  let '(_x1,y1,inf1) := (p) : (t_FpVesta_t × t_FpVesta_t × bool) in
  if
    andb (y1<>f_ZERO) (not inf1)
  then
    g1double_a_vesta p
  else
    (f_ZERO,f_ZERO,true).

Definition g1add_vesta (p : (t_FpVesta_t × t_FpVesta_t × bool)) (q : (t_FpVesta_t × t_FpVesta_t × bool)) : (t_FpVesta_t × t_FpVesta_t × bool) :=
  let '(x1,y1,inf1) := (p) : (t_FpVesta_t × t_FpVesta_t × bool) in
  let '(x2,y2,inf2) := (q) : (t_FpVesta_t × t_FpVesta_t × bool) in
  if
    inf1
  then
    q
  else
    if
      inf2
    then
      p
    else
      if
        p=.?q
      then
        g1double_vesta p
      else
        if
          not (andb (x1=.?x2) (y1=.?(f_ZERO.-y2)))
        then
          g1add_a_vesta p q
        else
          (f_ZERO,f_ZERO,true).

Definition g1neg_pallas (p : (t_FpPallas_t × t_FpPallas_t × bool)) : (t_FpPallas_t × t_FpPallas_t × bool) :=
  let '(x,y,inf) := (p) : (t_FpPallas_t × t_FpPallas_t × bool) in
  (x,f_ZERO.-y,inf).

Definition g1neg_vesta (p : (t_FpVesta_t × t_FpVesta_t × bool)) : (t_FpVesta_t × t_FpVesta_t × bool) :=
  let '(x,y,inf) := (p) : (t_FpVesta_t × t_FpVesta_t × bool) in
  (x,f_ZERO.-y,inf).

Definition g1mul_pallas (m : t_FpVesta_t) (p : (t_FpPallas_t × t_FpPallas_t × bool)) : (t_FpPallas_t × t_FpPallas_t × bool) :=
  let t := ((f_ZERO,f_ZERO,true)) : (t_FpPallas_t × t_FpPallas_t × bool) in
  let t := (f_fold (f_into_iter (Build_Range (@repr WORDSIZE32 0)(@repr WORDSIZE32 255))) t (fun t i =>
      let t := (g1double_pallas t) : (t_FpPallas_t × t_FpPallas_t × bool) in
      if
        impl__FpVesta__bit m ((@repr WORDSIZE32 254).-i)
      then
        let t := (g1add_pallas t p) : (t_FpPallas_t × t_FpPallas_t × bool) in
        t
      else
        t)) : (t_FpPallas_t × t_FpPallas_t × bool) in
  t.

Definition g1mul_vesta (m : t_FpPallas_t) (p : (t_FpVesta_t × t_FpVesta_t × bool)) : (t_FpVesta_t × t_FpVesta_t × bool) :=
  let t := ((f_ZERO,f_ZERO,true)) : (t_FpVesta_t × t_FpVesta_t × bool) in
  let t := (f_fold (f_into_iter (Build_Range (@repr WORDSIZE32 0)(@repr WORDSIZE32 255))) t (fun t i =>
      let t := (g1double_vesta t) : (t_FpVesta_t × t_FpVesta_t × bool) in
      if
        impl__FpPallas__bit m ((@repr WORDSIZE32 254).-i)
      then
        let t := (g1add_vesta t p) : (t_FpVesta_t × t_FpVesta_t × bool) in
        t
      else
        t)) : (t_FpVesta_t × t_FpVesta_t × bool) in
  t.
