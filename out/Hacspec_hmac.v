(* File automatically generated by Hacspec *)
From Hacspec Require Import Hacspec_Lib MachineIntegers.
From Coq Require Import ZArith.
Import List.ListNotations.
Open Scope Z_scope.
Open Scope bool_scope.

(*Not implemented yet? todo(item)*)

Require Import Hacspec_lib.

Require Import Hacspec_sha256.

Definition v_BLOCK_LEN : uint_size :=
  v_K_SIZE.

Notation PRK_t := (nseq int8 HASH_SIZE).
Definition PRK : PRK_t -> PRK_t :=
  id.

Notation Block_t := (nseq int8 BLOCK_LEN).
Definition Block : Block_t -> Block_t :=
  id.

Definition v_I_PAD : t_Block_t :=
  Block (array_from_list [U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54);
    U8 (@repr WORDSIZE8 54)]).

Definition v_O_PAD : t_Block_t :=
  Block (array_from_list [U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92);
    U8 (@repr WORDSIZE8 92)]).

Definition k_block (k : t_Seq_t t_U8_t) : t_Block_t :=
  if
    (len_under_impl_41 k)>.?v_BLOCK_LEN
  then
    update_start new_under_impl_40 (hash k)
  else
    update_start new_under_impl_40 k.

Definition hmac (k : t_Seq_t t_U8_t) (txt : t_Seq_t t_U8_t) : t_PRK_t :=
  let k_block := (k_block k) : t_Block_t in
  let h_in := (from_seq_under_impl_52 (k_block.^v_I_PAD)) : t_Seq_t t_U8_t in
  let h_in := (concat_under_impl_41 h_in txt) : t_Seq_t t_U8_t in
  let h_inner := (hash h_in) : t_Sha256Digest_t in
  let h_in := (from_seq_under_impl_52 (k_block.^v_O_PAD)) : t_Seq_t t_U8_t in
  let h_in := (concat_under_impl_41 h_in h_inner) : t_Seq_t t_U8_t in
  from_seq_under_impl_18 (hash h_in).
